<html>
<head>
<title>debug focus</title>
<link rel="import" href="ext/polymer/polymer.html">
<script src="ext/platform/platform.js"></script>

<style>
body {
    position: relative;
    background-color: #333;
    padding: 0px 100px;
    margin-top: 20px;
    color: white;
}
span.space {
    height: 5px;
    display: block;
}
.mybox {
    height: 100px;
    border: 5px solid #880;
    background-color: #222;
}
.mybox:focus {
    background-color: #aaa;
}
*:focus {
    outline: 0;
}
</style>

</head>

<body>

<debug-focus tabindex="1" id="focus-1">
    <debug-focus tabindex="1" id="focus-2">
        <debug-focus tabindex="1" id="focus-3">
            <div class="mybox" tabindex="1"></div>
        </debug-focus>
    </debug-focus>
</debug-focus>

<button onclick="focus1()">Focus 1</button>
<button onclick="focus2()">Focus 2</button>
<button onclick="focus3()">Focus 3</button>

<polymer-element name="debug-focus">
<template>
<style>
    .box {
        border: 5px solid #888;
        background-color: #222;
        padding: 20px;
    }
    .box.focused {
        border: 5px solid #09F;
    }
    .box:focus {
        outline: 0;
        background-color: #aaa;
    }
</style>

<div class="box {{ focused ? 'focused':'' }}"
    tabindex="1"
    on-focusin="{{onFocusIn}}"
    on-focusout="{{onFocusOut}}"
    on-keydown="{{onKeyDown}}"
    >
    <content/>
</div>
</template>

<script>
function focus1() {
    var fel = document.querySelector('#focus-1');
    fel.focus();
}
function focus2() {
    var fel = document.querySelector('#focus-2');
    fel.focus();
}
function focus3() {
    var fel = document.querySelector('#focus-3');
    fel.focus();
}

Polymer('debug-focus', {
    focused: false,
    ready: function() {
    },
    onFocusIn: function () {
        this.focused = true;
        event.stopPropagation();
        this.async( function () {
                        this.fire('focusin');
                    },
                    null, 
                    300 );
    },
    onFocusOut: function () {
        this.focused = false;
        event.stopPropagation();
        this.async( function () {
                        this.fire('focusout');
                    },
                    null, 
                    300 );
    },
    onKeyDown: function () {
        switch ( event.which ) {
            // esc
            case 27:
                event.target.blur(); 
            break;
        }
        event.stopPropagation();
    },
});
</script>

</polymer-element>

</body>
</html>
